{% extends "ISIBundle:Admin:index.html.twig" %}

{% block title %}
  Index User Management
{% endblock %}

{% block section %}
  <i class="users icon"></i>{{ 'Gestion des utilisateurs'|trans }}
{% endblock %}

{% block body %}
  <div>
    <table class="ui compact celled definition table">
      <thead class="full-width">
        <tr>
          <th colspan="6">{##}
            <a href="{{ path('fos_user_registration_register', {'as': asec, 'annexeId': annexe.id}) }}">
              <!-- <a href=""> -->
              <button class="ui left floated small primary labeled icon button">
                <i class="user icon"></i>{{ 'Ajouter un utilisateur'|trans }}
              </button>
            </a>
          </th>
        </tr>
        <tr>
          <th></th>
          <th>{{ 'Nom d\'utilisateur'|trans }}</th>
          <th>{{ 'Rôles'|trans }}</th>
          <th>{{ 'Dernière connexion'|trans }}</th>
          <th>{{ 'Etat du compte'|trans }}</th>
          <th>{{ 'Autres actions'|trans }}</th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
          <tr>
            <td class="collapsing">
              <div class="ui fitted slider checkbox">
                {% set checked = "" %}
                {% if user.enabled == true %}
                {% set checked = "checked" %}
                {% endif %}
                <input type="checkbox" {{checked}} name="{{ user.id }}" id="user[{{ user.id }}]" class="userStat">
                <label></label>
              </div>
            </td>
            <td>{{ user.username }}</td>
            <td>
              <ul>
                {% for role in user.roles %}
                  <li>{{ role }}</li>
                {% endfor %}
              </ul>
            </td>
            <td>{{ user.lastLogin|date("d-m-Y à h:m:s") }}</td>
            <td>{{ user.enabled }}</td>
            <td>
              <a href="{{path('add_roles_user', {'as': annee.id, 'annexeId': annexe.id, 'userId': user.id})}}"><i class="edit icon"></i>Ajouter rôles</a>
              <a href=""><i class="delete icon"></i></a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
      <tfoot class="full-width">
        <tr>
          <th></th>
          <th colspan="6">{##}
            <a href="{{ path('fos_user_registration_register', {'as': asec, 'annexeId': annexe.id}) }}">
            <!-- <a href=""> -->
              <button class="ui right floated small primary labeled icon button">
                <i class="user icon"></i> {{ 'Ajouter un utilisateur'|trans }}
              </button>
            </a>
          </th>
        </tr>
      </tfoot>
    </table>
  </div>
{% endblock %}


{% block scripts %}
    <script src="{{ asset('js/jquery-3.3.1.js') }}"></script>
    <script>
        $(document).ready(function() {
          $(".userStat").on("change", function(){
            var id = $(this).attr("name");
            // console.log(id);
          })
        });
    </script>
{% endblock %}
